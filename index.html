<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Baxo Solutions | Gamified Procurement</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;700;900&display=swap" rel="stylesheet">
<style>
    :root { --navy: #002D40; --lime: #A4D65E; }
    body { margin:0; padding:0; font-family:'Inter', sans-serif; height:100vh; overflow:hidden;
           background: linear-gradient(135deg, #f0f4f8 0%, #d9e2ec 100%); position: relative; }
    
    /* GAMIFICATION: Floating Bubbles */
    #bubble-layer { position: absolute; inset: 0; z-index: 40; overflow: hidden; pointer-events: none; }
    .float-bubble {
        position: absolute; border-radius: 50%; 
        background: rgba(255, 255, 255, 0.5); 
        border: 1px solid rgba(255,255,255,0.6);
        backdrop-filter: blur(2px);
        box-shadow: 0 4px 15px rgba(31, 38, 135, 0.1);
        cursor: pointer; pointer-events: auto;
        display: flex; flex-direction: column; align-items: center; justify-content: center;
        transition: transform 0.2s, background 0.2s, opacity 0.2s;
        animation: floatUp linear forwards;
        overflow: hidden;
    }
    .float-bubble:hover { transform: scale(1.1); background: rgba(255, 255, 255, 0.85); border-color: var(--lime); z-index: 60; }
    .float-bubble img { width: 55%; height: 55%; object-fit: contain; margin-bottom: 2px; pointer-events: none; opacity: 0.9; }
    .float-bubble span { font-size: 8px; font-weight: 800; color: var(--navy); text-align: center; line-height: 1; pointer-events: none; padding: 0 4px; text-transform: uppercase; }

    @keyframes floatUp {
        0% { transform: translateY(110vh) rotate(0deg); opacity: 0; }
        10% { opacity: 1; }
        90% { opacity: 1; }
        100% { transform: translateY(-20vh) rotate(360deg); opacity: 0; }
    }

    /* UI PANELS */
    .glass {
        background: rgba(255, 255, 255, 0.75);
        backdrop-filter: blur(12px);
        border: 1px solid rgba(255, 255, 255, 0.5);
    }
    .glass-card {
        background: rgba(255, 255, 255, 0.6);
        backdrop-filter: blur(8px);
        border: 1px solid rgba(255, 255, 255, 0.6);
        box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        transition: transform 0.2s, background 0.2s;
        position: relative; z-index: 20; 
    }
    .glass-card:hover { transform: translateY(-5px); background: rgba(255, 255, 255, 0.9); border-color: var(--lime); }

    /* CATALOG DRAWER */
    #catalog-drawer { 
        transition: transform 0.4s cubic-bezier(0.16, 1, 0.3, 1); 
        transform: translateX(100%);
    }
    #catalog-drawer.open { transform: translateX(0); }

    /* TOAST */
    .toast {
        position: fixed; top: 20px; left: 50%; transform: translateX(-50%) translateY(-100px);
        background: var(--navy); color: white; padding: 12px 24px; 
        z-index: 300; transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); 
        border-radius: 99px; font-size: 12px; font-weight: bold;
        box-shadow: 0 10px 30px rgba(0,45,64,0.3); display: flex; align-items: center; gap: 10px;
    }
    .toast.show { transform: translateX(-50%) translateY(0); }
    
    /* SCROLLBAR */
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
</style>
</head>
<body>

<div id="bubble-layer"></div>

<nav class="fixed top-0 w-full z-50 p-4">
    <div class="glass rounded-full px-6 py-3 flex justify-between items-center shadow-lg max-w-4xl mx-auto">
        <div class="flex items-center gap-3 cursor-pointer" onclick="location.reload()">
            <img src="logo.png" class="w-10 h-10 object-contain" onerror="this.src='https://placehold.co/40x40?text=Baxo'">
            <div>
                <h1 class="text-[var(--navy)] text-sm font-black leading-none uppercase">Baxo</h1>
                <p class="text-[8px] tracking-widest text-slate-500 uppercase font-bold">Solutions</p>
            </div>
        </div>
        <div class="flex gap-2">
            <button onclick="toggleCatalog()" class="bg-[var(--navy)] hover:bg-slate-700 text-white px-5 py-2 rounded-full font-bold uppercase text-[10px] transition-colors shadow-md flex items-center gap-2">
                üì¶ Catalog <span id="nav-cart-badge" class="bg-[var(--lime)] text-[var(--navy)] px-1.5 rounded-full text-[9px] hidden">0</span>
            </button>
            <button onclick="toggleProfile()" class="bg-white border border-slate-200 text-[var(--navy)] px-5 py-2 rounded-full font-bold uppercase text-[10px] hover:bg-slate-50 transition-colors shadow-sm">üë§ Card</button>
        </div>
    </div>
</nav>

<main class="relative z-10 flex flex-col justify-center h-full px-4 md:px-8 pointer-events-none">
    <div class="max-w-3xl mx-auto text-center pointer-events-auto mt-[-40px]">
        <h2 class="text-6xl md:text-8xl font-black text-[var(--navy)] leading-[0.9] mb-4 uppercase opacity-90 drop-shadow-sm">
            Prepared.<br>Protected.<br><span class="text-[var(--lime)]">Perfected.</span>
        </h2>
        <p class="text-slate-500 font-bold uppercase tracking-widest text-[10px] mb-10 bg-white/50 inline-block px-4 py-2 rounded-full backdrop-blur-sm">
            Catch a bubble to quick-add
        </p>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 max-w-2xl mx-auto relative z-20">
            <div onclick="openCategory('PPE Safety')" class="glass-card p-6 rounded-2xl cursor-pointer group">
                <div class="w-12 h-12 bg-white rounded-full flex items-center justify-center mx-auto mb-3 text-2xl shadow-sm group-hover:scale-110 transition-transform">üõ°Ô∏è</div>
                <h3 class="text-[var(--navy)] font-black uppercase text-sm">PPE & Safety</h3>
                <p class="text-[9px] text-slate-500 font-bold uppercase mt-1">Vests, Boots, Suits</p>
            </div>
            <div onclick="openCategory('Medical Consumables')" class="glass-card p-6 rounded-2xl cursor-pointer group">
                <div class="w-12 h-12 bg-white rounded-full flex items-center justify-center mx-auto mb-3 text-2xl shadow-sm group-hover:scale-110 transition-transform">üè•</div>
                <h3 class="text-[var(--navy)] font-black uppercase text-sm">Medical Supply</h3>
                <p class="text-[9px] text-slate-500 font-bold uppercase mt-1">Gloves, Syringes, Kits</p>
            </div>
            <div onclick="openCategory('Hygiene')" class="glass-card p-6 rounded-2xl cursor-pointer group">
                <div class="w-12 h-12 bg-white rounded-full flex items-center justify-center mx-auto mb-3 text-2xl shadow-sm group-hover:scale-110 transition-transform">‚ú®</div>
                <h3 class="text-[var(--navy)] font-black uppercase text-sm">Hygiene</h3>
                <p class="text-[9px] text-slate-500 font-bold uppercase mt-1">Chemicals & Cleaning</p>
            </div>
        </div>
    </div>
</main>

<div id="catalog-drawer" class="fixed inset-y-0 right-0 w-full md:w-[480px] z-50 glass shadow-2xl flex flex-col border-l border-white/50">
    <div class="p-6 border-b border-white/50 flex justify-between items-center bg-white/40">
        <div>
            <h2 class="text-2xl font-black text-[var(--navy)] uppercase">Inventory</h2>
            <p class="text-[10px] text-slate-500 font-bold uppercase tracking-wider">Select items & quantities</p>
        </div>
        <button onclick="toggleCatalog()" class="w-10 h-10 rounded-full bg-white hover:bg-red-50 text-slate-400 hover:text-red-500 transition-colors font-bold text-xl shadow-sm">&times;</button>
    </div>
    
    <div class="px-6 py-4 bg-white/50 border-b border-white/50">
        <div class="relative">
            <input type="text" id="search" onkeyup="renderCatalog()" placeholder="Search 'Syringes', 'Aprons'..." 
                   class="w-full bg-white border border-slate-200 rounded-xl pl-10 pr-4 py-3 text-xs font-bold focus:outline-none focus:border-[var(--lime)] focus:ring-2 focus:ring-[var(--lime)]/20 transition-all">
            <span class="absolute left-3 top-3 text-slate-400">üîç</span>
        </div>
    </div>

    <div id="catalog-list" class="flex-1 overflow-y-auto p-6 space-y-2"></div>

    <div class="p-6 bg-white border-t border-slate-100 shadow-[0_-10px_40px_rgba(0,0,0,0.05)]">
        <div class="flex justify-between items-center mb-2">
            <span class="font-black text-[var(--navy)] text-sm uppercase">Quote Cart</span>
            <span id="cart-count" class="bg-[var(--lime)] text-[var(--navy)] text-xs font-black px-3 py-1 rounded-full shadow-sm">0 Items</span>
        </div>
        
        <div id="cart-items-container" class="mb-4 pt-2 border-t border-slate-100 min-h-[60px] max-h-[150px] overflow-y-auto pr-2">
            <p class="text-[10px] text-slate-400 italic py-2">Your cart is empty.</p>
        </div>

        <button onclick="openContactModal()" class="w-full bg-[#25D366] text-white py-4 rounded-xl font-black uppercase tracking-widest shadow-lg hover:brightness-105 hover:shadow-green-500/30 transition-all flex items-center justify-center gap-2">
            <span>üöÄ</span> Submit via WhatsApp
        </button>
    </div>
</div>

<div id="profile-modal" class="fixed inset-0 z-[60] bg-[var(--navy)]/90 backdrop-blur-sm hidden items-center justify-center">
    <div class="bg-white rounded-[2rem] p-8 max-w-sm w-full text-center relative mx-4 shadow-2xl border-4 border-[var(--lime)]">
        <div class="w-16 h-1 bg-slate-200 rounded-full mx-auto mb-6"></div>
        <button onclick="toggleProfile()" class="absolute top-4 right-4 text-2xl text-slate-300 hover:text-[var(--navy)] transition-colors">&times;</button>
        <div class="relative inline-block mb-4">
            <img src="md-portrait.jpg" class="w-24 h-24 rounded-full border-4 border-white shadow-xl object-cover bg-slate-100" onerror="this.src='https://placehold.co/100x100?text=MD'">
            <div class="absolute bottom-0 right-0 bg-[var(--lime)] text-[var(--navy)] text-[10px] font-black px-2 py-1 rounded-full border-2 border-white">CEO</div>
        </div>
        <h3 class="text-[var(--navy)] font-black uppercase text-xl leading-none">Baxo Solutions</h3>
        <p class="text-[10px] text-slate-400 font-bold uppercase mb-6 tracking-widest mt-1">Medical ‚Ä¢ Safety ‚Ä¢ Hygiene</p>
        <div class="bg-slate-50 p-4 rounded-xl mb-6 text-left border border-slate-100">
            <p class="text-[10px] text-slate-500 font-bold uppercase mb-2">Our Mission:</p>
            <p class="text-xs text-[var(--navy)] font-bold italic">"Standardizing Excellence in Botswana's Supply Chain."</p>
        </div>
        <div class="space-y-3">
            <button onclick="shareBusinessCard()" class="w-full bg-[#25D366] hover:bg-green-500 text-white py-4 rounded-xl font-bold text-xs uppercase shadow-lg transition-all flex items-center justify-center gap-2">
                <span>üì≤</span> Share Business Card
            </button>
            <button onclick="downloadProfile()" class="w-full border-2 border-slate-100 hover:border-[var(--navy)] text-[var(--navy)] py-4 rounded-xl font-bold text-xs uppercase transition-all flex items-center justify-center gap-2">
                <span>üìÑ</span> Download Profile PDF
            </button>
        </div>
    </div>
</div>

<div id="contact-modal" class="fixed inset-0 z-[70] bg-[var(--navy)]/95 backdrop-blur-sm hidden items-center justify-center">
    <div class="bg-white rounded-3xl p-8 max-w-sm w-full relative mx-4 shadow-2xl animate-bounce-in">
        <button onclick="closeContactModal()" class="absolute top-4 right-4 text-2xl text-slate-300 hover:text-[var(--navy)]">&times;</button>
        <h3 class="text-[var(--navy)] font-black uppercase text-xl mb-1">Final Step</h3>
        <p class="text-xs text-slate-400 font-bold uppercase mb-6">Enter your details to generate quote</p>
        
        <form onsubmit="finalSubmit(event)" class="space-y-4">
            <div>
                <label class="text-[10px] font-black text-[var(--navy)] uppercase">Full Name</label>
                <input type="text" id="cust-name" required class="w-full bg-slate-50 border border-slate-200 rounded-xl px-4 py-3 text-xs font-bold focus:border-[var(--lime)] outline-none mt-1">
            </div>
            <div>
                <label class="text-[10px] font-black text-[var(--navy)] uppercase">Email Address</label>
                <input type="email" id="cust-email" required class="w-full bg-slate-50 border border-slate-200 rounded-xl px-4 py-3 text-xs font-bold focus:border-[var(--lime)] outline-none mt-1">
            </div>
            <div>
                <label class="text-[10px] font-black text-[var(--navy)] uppercase">Contact Number</label>
                <input type="tel" id="cust-phone" required class="w-full bg-slate-50 border border-slate-200 rounded-xl px-4 py-3 text-xs font-bold focus:border-[var(--lime)] outline-none mt-1">
            </div>
            <button type="submit" class="w-full bg-[var(--lime)] text-[var(--navy)] py-4 rounded-xl font-black uppercase tracking-widest shadow-lg hover:brightness-105 mt-4">
                Generate Quote üöÄ
            </button>
        </form>
    </div>
</div>

<div id="toast" class="toast">
    <span class="text-lg">‚úÖ</span>
    <span>Item Added!</span>
</div>

<script>
// --- INVENTORY DATA (EXPANDED SIZES) ---
const inventory = [
  // MEDICAL CONSUMABLES
  { n:"Alcohol Swabs", i:"alcohol_swabs.jpg", c:"Medical Consumables", u:["Box 100", "Box 200"] },
  { n:"Bandages", i:"bandages.jpg", c:"Medical Consumables", u:["50mm", "75mm", "100mm", "150mm"] },
  { n:"IV Cannulas", i:"cannulas.jpg", c:"Medical Consumables", u:["18G", "20G", "22G", "24G"] },
  { n:"Cotton Wool", i:"cotton.jpg", c:"Medical Consumables", u:["100g", "500g"] },
  { n:"Dental Supplies", i:"dental.jpg", c:"Medical Consumables", u:["Standard Pack"] },
  { n:"Tongue Depressors", i:"depressors.jpg", c:"Medical Consumables", u:["Box 100"] },
  { n:"Linen Savers", i:"linensaver.jpg", c:"Medical Consumables", u:["Pack 20 (Standard)", "Pack 20 (Large)"] }, 
  { n:"First Aid Kit", i:"firstaid.jpg", c:"Medical Consumables", u:["Reg 3 Kit", "Reg 7 Kit", "Refill Only"] },
  { n:"Gauze Swabs", i:"gauze.jpg", c:"Medical Consumables", u:["100x100mm (Sterile)", "100x100mm (Non-Sterile)"] },
  { n:"HIV Test Kits", i:"hiv_kits.jpg", c:"Medical Consumables", u:["Single Kit", "Box of 25"] },
  { n:"Latex Gloves", i:"latex.jpg", c:"Medical Consumables", u:["XS", "S", "M", "L", "XL"] },
  { n:"Needles", i:"needles.jpg", c:"Medical Consumables", u:["18G", "20G", "21G", "22G", "23G", "25G"] },
  { n:"Nitrile Gloves", i:"nitrile.jpg", c:"Medical Consumables", u:["XS", "S", "M", "L", "XL"] },
  { n:"Hand Sanitizer", i:"sanitizer.jpg", c:"Medical Consumables", u:["500ml", "1L", "5L", "25L"] },
  { n:"Sharps Bin", i:"sharps_bin.jpg", c:"Medical Consumables", u:["5 Liter", "10 Liter", "20 Liter"] },
  { n:"Spill Kit", i:"spill.jpg", c:"Medical Consumables", u:["Bio-Hazard", "Chemical"] },
  { n:"Syringes", i:"syringes.jpg", c:"Medical Consumables", u:["2ml", "5ml", "10ml", "20ml", "50ml"] },
  { n:"Surgical Tape", i:"tape.jpg", c:"Medical Consumables", u:["12mm", "24mm", "48mm"] },
  { n:"Urine Cups", i:"urine_cups.jpg", c:"Medical Consumables", u:["Standard Unit"] },

  // PPE & SAFETY
  { n:"Plastic Aprons", i:"apron.jpg", c:"PPE Safety", u:["Pack 100 (White)", "Pack 100 (Blue)", "Pack 100 (Red)"] },
  { n:"Sleeve Protectors", i:"sleeveprotector.jpg", c:"PPE Safety", u:["Pair (Blue)", "Pair (White)"] },
  { n:"Beard Covers", i:"beardcover.jpg", c:"PPE Safety", u:["Pack 100"] },
  { n:"Mop Caps", i:"mopcap.jpg", c:"PPE Safety", u:["White", "Blue", "Red", "Green", "Yellow"] },
  { n:"Surgeon Caps", i:"surgeoncap.jpg", c:"PPE Safety", u:["Pack 100"] },
  { n:"Safety Shoes", i:"shoes.jpg", c:"PPE Safety", u:["Size 3", "Size 4", "Size 5", "Size 6", "Size 7", "Size 8", "Size 9", "Size 10", "Size 11", "Size 12", "Size 13"] },
  { n:"Rubber Gloves", i:"rubbergloves.jpg", c:"PPE Safety", u:["Elbow Length", "Standard Length"] },

  // MEDICAL EQUIPMENT
  { n:"Hospital Bed", i:"bed.jpg", c:"Medical Equipment", u:["Manual", "Electric", "ICU Spec"] },
  { n:"Wheelchair", i:"wheelchair.jpg", c:"Medical Equipment", u:["Standard", "Heavy Duty", "Commode"] },

  // PLACEHOLDERS (Expanded Sizes)
  { n:"Two-Tone Conti Suit", i:"placeholder_suit.jpg", c:"PPE Safety", u:["30", "32", "34", "36", "38", "40", "42", "44", "46", "48", "50", "52", "54"] },
  { n:"Reflective Vest", i:"placeholder_vest.jpg", c:"PPE Safety", u:["S", "M", "L", "XL", "2XL", "3XL", "4XL", "5XL"] },
  { n:"Dust Mask (FFP2)", i:"placeholder_mask.jpg", c:"PPE Safety", u:["Box 20"] },
  { n:"Hospital Disinfectant", i:"placeholder_chem.jpg", c:"Hygiene", u:["5L", "25L"] },
  { n:"Industrial Detergent", i:"placeholder_det.jpg", c:"Hygiene", u:["5L", "25L"] }
];

let cart = [];

// --- BUBBLE ENGINE ---
function spawnBubble() {
    const validItems = inventory.filter(i => !i.i.includes('placeholder'));
    const item = validItems[Math.floor(Math.random() * validItems.length)];
    const el = document.createElement('div');
    el.className = 'float-bubble';
    
    // Size 60px - 100px
    const size = Math.floor(Math.random() * 40) + 60; 
    el.style.width = `${size}px`;
    el.style.height = `${size}px`;
    el.style.left = `${Math.random() * 90}%`;
    el.style.animationDuration = `${Math.random() * 8 + 12}s`; 
    
    const fallback = 'logo.png';
    el.innerHTML = `<img src="${item.i}" onerror="this.src='${fallback}'"><span>${item.n}</span>`;
    
    el.onclick = (e) => {
        e.stopPropagation();
        addToCart(item, item.u[0]);
        el.style.transform = "scale(1.5)"; 
        el.style.opacity = "0";
        setTimeout(() => el.remove(), 300);
    };
    
    document.getElementById('bubble-layer').appendChild(el);
    setTimeout(() => { if(el.parentNode) el.remove(); }, 20000);
}
setInterval(spawnBubble, 2000);

// --- APP LOGIC ---
function toggleCatalog() {
    const drawer = document.getElementById('catalog-drawer');
    drawer.classList.toggle('open');
    if(drawer.classList.contains('open')) renderCatalog();
}

function openCategory(catName) {
    toggleCatalog();
    document.getElementById('search').value = catName;
    renderCatalog();
}

function toggleProfile() {
    const modal = document.getElementById('profile-modal');
    modal.classList.toggle('hidden');
    modal.classList.toggle('flex');
}

function downloadProfile() {
    const link = document.createElement('a');
    link.href = 'profile.pdf'; 
    link.download = 'Baxo_Solutions_Profile.pdf';
    link.click();
}

// --- UPDATED SHARE FUNCTION (Includes Website Link) ---
function shareBusinessCard() {
    let msg = `üõ°Ô∏è *Baxo Solutions Digital Card*\n\n` +
              `üëã Hi there! I wanted to share our official supply catalog with you.\n\n` +
              `üè• *Medical Supplies*\n` +
              `üöß *PPE & Safety*\n` +
              `‚ú® *Hygiene & Cleaning*\n\n` +
              `üëá *Tap to view full inventory & order:*\n` +
              `https://baxosolutions.com`; // REPLACE WITH YOUR ACTUAL LINK
    
    window.open(`https://wa.me/?text=${encodeURIComponent(msg)}`);
}

function renderCatalog() {
    const term = document.getElementById('search').value.toLowerCase();
    const container = document.getElementById('catalog-list');
    container.innerHTML = '';

    const filtered = inventory.filter(i => i.n.toLowerCase().includes(term) || i.c.toLowerCase().includes(term));
    const categories = [...new Set(filtered.map(i => i.c))];

    if(filtered.length === 0) {
        container.innerHTML = `<div class="text-center text-slate-400 text-xs py-10 font-bold uppercase">No items found</div>`;
        return;
    }

    categories.forEach(cat => {
        const catHeader = document.createElement('div');
        catHeader.className = "text-[10px] font-black text-slate-400 uppercase tracking-widest mt-4 mb-2 ml-1";
        catHeader.innerText = cat;
        container.appendChild(catHeader);

        filtered.filter(i => i.c === cat).forEach(item => {
            const selectId = `sel-${item.n.replace(/[^a-zA-Z0-9]/g, '')}`;
            const isPlaceholder = item.i.includes('placeholder');
            const imgHTML = isPlaceholder 
                ? `<div class="w-10 h-10 bg-slate-200 rounded-lg flex items-center justify-center text-xs">üì¶</div>`
                : `<img src="${item.i}" class="w-10 h-10 object-contain bg-white rounded-lg border border-slate-200" onerror="this.src='logo.png'">`;

            const optionHTML = item.u.length > 1 
                ? `<select id="${selectId}" class="bg-white border border-slate-200 text-[9px] font-bold rounded p-1 w-full outline-none focus:border-[var(--navy)] mt-1">
                     ${item.u.map(opt => `<option value="${opt}">${opt}</option>`).join('')}
                   </select>`
                : `<p class="text-[9px] text-slate-400 font-bold bg-slate-100 px-2 rounded inline-block mt-1">${item.u[0]}</p>`;

            const div = document.createElement('div');
            div.className = "bg-slate-50 p-2 rounded-xl border border-slate-100 flex flex-col gap-2 hover:border-[var(--lime)] transition-colors group mb-2";
            div.innerHTML = `
                <div class="flex items-center justify-between w-full">
                    <div class="flex items-center gap-3 w-full">
                        ${imgHTML}
                        <div class="flex-1">
                            <h4 class="font-bold text-[var(--navy)] text-xs uppercase group-hover:text-[var(--lime)] transition-colors">${item.n}</h4>
                            ${optionHTML}
                        </div>
                    </div>
                    <button onclick="addToCartFromCatalog('${item.n}', '${selectId}')" class="bg-white border border-slate-200 text-[var(--navy)] hover:bg-[var(--navy)] hover:text-white w-8 h-8 rounded-lg font-black transition-colors shadow-sm flex-shrink-0 ml-2">+</button>
                </div>`;
            container.appendChild(div);
        });
    });
}

function addToCartFromCatalog(name, selectId) {
    const item = inventory.find(i => i.n === name);
    let size = item.u[0];
    const el = document.getElementById(selectId);
    if(el) size = el.value;
    addToCart(item, size);
}

function addToCart(item, size) {
    const existing = cart.find(c => c.n === item.n && c.size === size);
    if(existing) {
        existing.qty++;
    } else {
        cart.push({ n: item.n, size: size, qty: 1 });
    }
    updateCartUI();
    showToast();
}

function updateCartUI() {
    const count = cart.reduce((acc, item) => acc + item.qty, 0);
    document.getElementById('cart-count').innerText = `${count} Items`;
    const badge = document.getElementById('nav-cart-badge');
    badge.innerText = count;
    badge.style.display = count > 0 ? 'inline-block' : 'none';
    
    const container = document.getElementById('cart-items-container');
    if(cart.length === 0) {
        container.innerHTML = `<p class="text-[10px] text-slate-400 italic py-2">Your cart is empty.</p>`;
        return;
    }

    container.innerHTML = `<div class="flex flex-col gap-2">
        ${cart.map((c, i) => `
            <div class="flex justify-between items-center bg-slate-50 p-2 rounded border border-slate-100">
                <div class="flex flex-col">
                    <span class="text-[10px] font-bold text-[var(--navy)] uppercase leading-tight">${c.n}</span>
                    <span class="text-[9px] text-slate-400 font-bold">${c.size}</span>
                </div>
                <div class="flex items-center gap-1 bg-white rounded border border-slate-200 px-1">
                    <button onclick="modQty(${i}, -1)" class="w-6 h-6 flex items-center justify-center font-bold text-slate-400 hover:text-red-500">-</button>
                    <span class="text-[10px] font-black w-4 text-center">${c.qty}</span>
                    <button onclick="modQty(${i}, 1)" class="w-6 h-6 flex items-center justify-center font-bold text-slate-400 hover:text-green-500">+</button>
                </div>
            </div>`).join('')}
    </div>`;
}

function modQty(index, amount) {
    cart[index].qty += amount;
    if(cart[index].qty <= 0) cart.splice(index, 1);
    updateCartUI();
}

function showToast() {
    const t = document.getElementById('toast');
    t.classList.add('show');
    setTimeout(() => t.classList.remove('show'), 2000);
}

// --- MANDATORY CONTACT MODAL LOGIC ---
function openContactModal() {
    if(!cart.length) return alert("Your quote is empty.");
    document.getElementById('contact-modal').classList.remove('hidden');
    document.getElementById('contact-modal').classList.add('flex');
}

function closeContactModal() {
    document.getElementById('contact-modal').classList.add('hidden');
    document.getElementById('contact-modal').classList.remove('flex');
}

function finalSubmit(e) {
    e.preventDefault(); // Prevent page reload
    
    const name = document.getElementById('cust-name').value;
    const email = document.getElementById('cust-email').value;
    const phone = document.getElementById('cust-phone').value;
    
    let msg = `*BAXO SOLUTIONS - QUOTE REQUEST*\n`;
    msg += `üë§ ${name}\nüìß ${email}\nüì± ${phone}\n\n`;
    msg += `*ORDER DETAILS:*\n`;
    cart.forEach(i => { msg += `üì¶ ${i.n}\n   Spec: ${i.size}\n   Qty: ${i.qty}\n\n`; });
    msg += `_Sent from Digital Portal_`;
    
    window.open(`https://wa.me/26773811270?text=${encodeURIComponent(msg)}`);
    closeContactModal();
}

// Start
renderCatalog();
</script>
</body>
</html>
